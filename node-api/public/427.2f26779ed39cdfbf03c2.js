(self.webpackChunkangular=self.webpackChunkangular||[]).push([[427],{9427:(e,t,s)=>{"use strict";s.r(t),s.d(t,{UsersModule:()=>I});var i=s(3738),r=s(6633),a=s(6090),o=s(7988),l=s(5551),n=s(9765),d=s(8002),u=s(2340);class c{constructor(){this.userName="",this.email="",this.status=1,this.user_type=u.N.role.userRole}}class m{constructor(){this.userName="",this.email="",this.user_type=""}}var h=s(793),g=s(9866),Z=s(9699),p=s(2057),f=s(6355),A=s(5921);const b=["showAddEditUserModal"],U=["deleteUserModal"];function T(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"tr"),h.TgZ(1,"th",44),h._uU(2),h.qZA(),h.TgZ(3,"td"),h._uU(4),h.qZA(),h.TgZ(5,"td"),h._uU(6),h.qZA(),h.TgZ(7,"td"),h._uU(8),h.qZA(),h.TgZ(9,"td"),h._uU(10),h.ALo(11,"date"),h.qZA(),h.TgZ(12,"td"),h.TgZ(13,"ui-switch",45),h.NdJ("change",function(){const t=h.CHM(e).$implicit;return h.oxw().changeUserStatus(t)})("ngModelChange",function(t){return h.CHM(e).$implicit.status=t}),h.qZA(),h.qZA(),h.TgZ(14,"td",9),h.TgZ(15,"div",46),h.TgZ(16,"button",47),h.NdJ("click",function(){const t=h.CHM(e).$implicit;return h.oxw().showAddEditModal(t)}),h._UZ(17,"i",48),h.qZA(),h.TgZ(18,"button",49),h.NdJ("click",function(){const t=h.CHM(e).$implicit;return h.oxw().showUserDeleteModal(t)}),h._UZ(19,"i",50),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){const e=t.$implicit,s=t.index;h.xp6(2),h.Oqu(s+1),h.xp6(2),h.Oqu(e.userName),h.xp6(2),h.Oqu(e.email),h.xp6(2),h.Oqu(1==e.user_type?"Manager":"User"),h.xp6(2),h.Oqu(h.xi3(11,6,e.createdAt,"d/M/yyyy")),h.xp6(3),h.Q6J("ngModel",e.status)}}function q(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1,"User Name Required."),h.qZA())}function v(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1,"Minimum length is 3."),h.qZA())}function x(e,t){if(1&e&&(h.TgZ(0,"p",51),h.YNc(1,q,2,0,"span",52),h.YNc(2,v,2,0,"span",52),h.qZA()),2&e){const e=h.oxw();h.xp6(1),h.Q6J("ngIf",e.invalidform.userName.errors.required),h.xp6(1),h.Q6J("ngIf",e.invalidform.userName.errors.minlength)}}function _(e,t){1&e&&(h.TgZ(0,"span",53),h._uU(1,"@amwebtech.com"),h.qZA())}function y(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1,"Email Required."),h.qZA())}function N(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1,"Minimum length is 3."),h.qZA())}function M(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1," This Email Already Exists, please try another. "),h.qZA())}function w(e,t){if(1&e&&(h.TgZ(0,"p",51),h.YNc(1,y,2,0,"span",52),h.YNc(2,N,2,0,"span",52),h.YNc(3,M,2,0,"span",52),h.qZA()),2&e){const e=h.oxw();h.xp6(1),h.Q6J("ngIf",e.invalidform.email.errors.required),h.xp6(1),h.Q6J("ngIf",e.invalidform.email.errors.minlength),h.xp6(1),h.Q6J("ngIf",null==e.invalidform.email.errors?null:e.invalidform.email.errors.emailExists)}}function F(e,t){if(1&e&&(h.TgZ(0,"option",54),h._uU(1),h.qZA()),2&e){const e=t.$implicit;h.Q6J("ngValue","adminRole"==e?1:2),h.xp6(1),h.hij(" ","adminRole"===e?"Manager":"User"," ")}}const E=function(){return{backdrop:"static",keyboard:!1,animated:!0}},J=[{path:"",component:(()=>{class e{constructor(e,t,s,r,a,d){this.globalService=e,this.usersService=t,this.spinner=s,this.toastr=r,this.alertService=a,this.fb=d,this.title="Manage Users | Estimation Calculator",this.userInfo=new c,this.userForm=new i.cw({}),this.userRoles=u.N.role,this.usersList=[],this.datatableElement=o.G,this.dtOptions={},this.dtTrigger=new n.xQ,this.newUserAlready=!1,this.showAddEditUserModal=l.oB,this.deleteUserModal=l.oB,this.requiredValidation=new m,this.inValidateCheck={email:!1,emailExits:!0},this.getUsersList()}ngOnInit(){this.dtOptions={responsive:!0,scrollX:!0,scrollY:"350px",scrollCollapse:!0,columnDefs:[{targets:5,orderable:!1,searchable:!1},{targets:6,orderable:!1,searchable:!1}]},this.userRoles=Object.keys(this.userRoles),this.globalService.getPageTitle(this.title),this.validateForm()}validateForm(){this.userForm=this.fb.group({_id:"",userName:["",[i.kI.required,i.kI.minLength(3)]],email:[{value:"",disabled:!1},[i.kI.required,i.kI.minLength(3)],[this.emailExistValidator()]],status:1,user_type:u.N.role.userRole})}ngAfterViewInit(){this.dtTrigger.next()}emailExistValidator(){return e=>this.usersService.emailAlreadyExists({email:e.value+u.N.emaildomain}).pipe((0,d.U)(e=>200===e.status?{emailExists:!0}:null))}getUsersList(){this.usersService.getUsersList().subscribe(e=>{this.spinner.show(),200==e.status&&(this.spinner.hide(),this.datatableElement.dtInstance.then(t=>{t.destroy(),this.dtTrigger.next(),this.usersList=e.data,this.spinner.hide()}))},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}checkvalidation(e){return this.userForm.get(e)&&this.userForm.get(e).invalid?"text-danger":"text-success"}get invalidform(){return this.userForm.controls}showAddEditModal(e){this.validateForm(),this.alertService.clear(),e&&e._id?(this.userForm.value=this.userForm.reset(e),setTimeout(()=>{this.userForm.controls.email.disable()})):setTimeout(()=>{this.userForm.controls.email.enable()}),this.showAddEditUserModal.show()}closeModel(){this.showAddEditUserModal.hide(),this.deleteUserModal.hide(),this.validateForm()}showUserDeleteModal(e){this.userInfo=e,this.deleteUserModal.show()}addUser(){if(this.alertService.clear(),this.userForm.invalid)return this.alertService.error("*Please Fill All Fields are mandatory."),!1;let e=Object.assign({},this.userForm.value);e._id||(e.email=e.email+u.N.emaildomain,delete e._id),this.spinner.show(),this.usersService.saveUserInfo(e).subscribe(e=>{console.log("dataRes",e),200===e.status&&(this.spinner.hide(),this.toastr.success(e.message,"Success!"),e=e.data,this.closeModel(),this.getUsersList())},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}deleteUser(){this.spinner.show(),this.usersService.deleteUser(this.userInfo).subscribe(e=>{200===e.status&&(this.closeModel(),this.spinner.hide(),this.getUsersList(),this.toastr.success("User deleted successfully.","Success"))},e=>{this.closeModel(),this.spinner.hide(),this.toastr.error("There are some server error. Please check connection.","Error")})}changeUserStatus(e){this.usersService.saveUserInfo({_id:e._id,status:e.status?0:1}).subscribe(e=>{if(200===e.status){e=e.data,this.spinner.hide(),this.toastr.success("User status has been changed successfully.","Success!");let t=this.usersList.findIndex(t=>t._id===e._id);t&&(this.usersList[t].status=e.status)}},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(r.Uh),h.Y36(r.fz),h.Y36(g.t2),h.Y36(Z._W),h.Y36(r.c9),h.Y36(i.qu))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-users"]],viewQuery:function(e,t){if(1&e&&(h.Gf(o.G,5),h.Gf(b,5),h.Gf(U,5)),2&e){let e;h.iGM(e=h.CRH())&&(t.datatableElement=e.first),h.iGM(e=h.CRH())&&(t.showAddEditUserModal=e.first),h.iGM(e=h.CRH())&&(t.deleteUserModal=e.first)}},decls:92,vars:20,consts:[[1,"d-flex","flex-row"],[1,"col-12"],[1,"opacity-50"],[1,"container-fluid","app-user","bg-white","py-3","dataDisplaySection"],[1,"d-flex","justify-content-end","mb-3"],[1,"btn","btn-sm","btn-primary","ms-3",3,"click"],[1,"fas","fa-plus","me-2"],["datatable","",1,"table","table-bordered","table-hover","table-striped",3,"dtOptions","dtTrigger"],[1,"text-nowrap"],[1,"text-center"],[1,"text-wrap"],[4,"ngFor","ngForOf"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade",3,"config"],["showAddEditUserModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["id","userForm","role","form","novalidate","",3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"row","row-xs","align-items-center"],[1,"mb-3"],["for","userName",1,"form-label"],[1,"fas","fa-star","fa-xs"],["type","text","id","userName","maxlength","15","placeholder","Enter userName","name","userName","formControlName","userName",1,"form-control"],["class","text-danger",4,"ngIf"],["for","Email",1,"form-label"],[3,"ngClass"],[1,"input-group"],["type","text","id","Email","placeholder","Enter Email Address","autocomplete","off","name","email","formControlName","email",1,"form-control",3,"disabled"],["class","input-group-text",4,"ngIf"],["for","userType",1,"form-label"],["id","UserType","name","user_type","formControlName","user_type",1,"form-select"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"modal-footer","border-top-0","justify-content-start"],["type","submit",1,"btn","btn-primary",3,"disabled"],["deleteUserModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"fa","fa-trash"],[1,"modal-footer","border-top-0","d-flex","justify-content-start"],["type","button",1,"btn","btn-default","me-1",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["scope","row"],["color","#4285F4","defaultBgColor","#d9d9d9","labelOn","Active","labelOff","Inactive",3,"ngModel","change","ngModelChange"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-sm","edit","me-1",3,"click"],[1,"far","fa-edit"],["type","button",1,"btn","btn-sm","delete",3,"click"],[1,"far","fa-trash-alt"],[1,"text-danger"],[4,"ngIf"],[1,"input-group-text"],[3,"ngValue"]],template:function(e,t){1&e&&(h.TgZ(0,"div",0),h.TgZ(1,"div",1),h.TgZ(2,"h4",2),h._uU(3,"Manage Users"),h.qZA(),h._UZ(4,"hr"),h.qZA(),h.qZA(),h.TgZ(5,"div",3),h.TgZ(6,"div",4),h.TgZ(7,"div"),h.TgZ(8,"button",5),h.NdJ("click",function(){return t.showAddEditModal()}),h._UZ(9,"i",6),h._uU(10,"Add New"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(11,"table",7),h.TgZ(12,"thead"),h.TgZ(13,"tr",8),h.TgZ(14,"th"),h._uU(15,"S.No"),h.qZA(),h.TgZ(16,"th"),h._uU(17,"Username"),h.qZA(),h.TgZ(18,"th"),h._uU(19,"Email I'd"),h.qZA(),h.TgZ(20,"th"),h._uU(21,"Account Type"),h.qZA(),h.TgZ(22,"th"),h._uU(23,"Created At"),h.qZA(),h.TgZ(24,"th"),h._uU(25,"Status"),h.qZA(),h.TgZ(26,"th",9),h._uU(27,"Actions"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(28,"tbody",10),h.YNc(29,T,20,9,"tr",11),h.qZA(),h.qZA(),h.qZA(),h.TgZ(30,"div",12,13),h.TgZ(32,"div",14),h.TgZ(33,"div",15),h.TgZ(34,"div",16),h.TgZ(35,"h4",17),h._uU(36),h.qZA(),h.TgZ(37,"button",18),h.NdJ("click",function(){return t.closeModel()}),h.TgZ(38,"span",19),h._uU(39,"\xd7"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(40,"form",20),h.NdJ("ngSubmit",function(){return t.addUser()}),h.TgZ(41,"div",21),h.TgZ(42,"div",22),h.TgZ(43,"div",23),h.TgZ(44,"label",24),h._uU(45,"User's Full Name "),h.TgZ(46,"sup"),h._UZ(47,"i",25),h.qZA(),h.qZA(),h._UZ(48,"input",26),h.YNc(49,x,3,2,"p",27),h.qZA(),h.TgZ(50,"div",23),h.TgZ(51,"label",28),h._uU(52,"Email address "),h.TgZ(53,"sup",29),h._UZ(54,"i",25),h.qZA(),h.qZA(),h.TgZ(55,"div",30),h._UZ(56,"input",31),h.YNc(57,_,2,0,"span",32),h.qZA(),h.YNc(58,w,4,3,"p",27),h.qZA(),h.TgZ(59,"div",23),h.TgZ(60,"label",33),h._uU(61,"User Type"),h.qZA(),h.TgZ(62,"select",34),h.YNc(63,F,2,2,"option",35),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h._UZ(64,"app-alert"),h.TgZ(65,"div",36),h.TgZ(66,"button",37),h._uU(67),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(68,"div",12,38),h.TgZ(70,"div",39),h.TgZ(71,"div",15),h.TgZ(72,"div",16),h.TgZ(73,"h4",17),h._UZ(74,"i",40),h._uU(75," Delete User"),h.qZA(),h.TgZ(76,"button",18),h.NdJ("click",function(){return t.closeModel()}),h.TgZ(77,"span",19),h._uU(78,"\xd7"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(79,"div",21),h.TgZ(80,"h4"),h._uU(81,"Are you sure want to delete this User?"),h.qZA(),h.TgZ(82,"p"),h.TgZ(83,"b"),h._uU(84,"User Name :"),h.qZA(),h._uU(85),h._UZ(86,"br"),h.qZA(),h.qZA(),h.TgZ(87,"div",41),h.TgZ(88,"button",42),h.NdJ("click",function(){return t.closeModel()}),h._uU(89,"Close"),h.qZA(),h.TgZ(90,"button",43),h.NdJ("click",function(){return t.deleteUser()}),h._uU(91,"Delete"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(11),h.Q6J("dtOptions",t.dtOptions)("dtTrigger",t.dtTrigger),h.xp6(18),h.Q6J("ngForOf",t.usersList),h.xp6(1),h.Q6J("config",h.DdM(18,E)),h.xp6(6),h.hij(" ",null!=t.userForm&&null!=t.userForm.value&&t.userForm.value._id?"Edit":"Add"," User"),h.xp6(4),h.Q6J("formGroup",t.userForm),h.xp6(6),h.Tol(t.checkvalidation("userName")),h.xp6(3),h.Q6J("ngIf",t.invalidform.userName.invalid&&(t.invalidform.userName.dirty||t.invalidform.userName.touched)),h.xp6(4),h.Q6J("ngClass",t.checkvalidation("email")),h.xp6(3),h.Q6J("disabled",!!t.userForm.value._id),h.xp6(1),h.Q6J("ngIf",!(null!=t.userForm&&null!=t.userForm.value&&t.userForm.value._id)),h.xp6(1),h.Q6J("ngIf",t.invalidform.email.invalid&&(t.invalidform.email.dirty||t.invalidform.email.touched)),h.xp6(5),h.Q6J("ngForOf",t.userRoles),h.xp6(3),h.Q6J("disabled",!t.userForm.valid),h.xp6(1),h.hij("",null!=t.userForm&&null!=t.userForm.value&&t.userForm.value._id?"Update":"Add"," "),h.xp6(1),h.Q6J("config",h.DdM(19,E)),h.xp6(17),h.hij(" ",t.userInfo.userName," "))},directives:[o.G,p.sg,l.oB,i._Y,i.JL,i.sg,i.Fj,i.nD,i.JJ,i.u,p.O5,p.mk,i.EJ,f.w,A.o,i.On,i.YN,i.Kr],pipes:[p.uU],styles:[""]}),e})(),pathMatch:"full"}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[a.Bz.forChild(J)],a.Bz]}),e})(),I=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[r.eY,i.UX,k]]}),e})()}}]);