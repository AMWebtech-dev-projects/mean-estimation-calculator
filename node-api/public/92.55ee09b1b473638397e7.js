(self.webpackChunkangular=self.webpackChunkangular||[]).push([[92],{9092:(e,t,o)=>{"use strict";o.r(t),o.d(t,{HourlyModule:()=>N});var i=o(6090),a=o(5551),n=o(8525),r=o(6633),s=o(2340);class l extends r.HA{constructor(){super(...arguments),this.hourly=20,this.weeks=12,this.type=s.N.calculationType.hourly,this.rateOffered=0,this.finalPriceWithDiscount=0,this.timeIndex=0,this.totalCost=0}}var c=o(793),u=o(9866),h=o(9699),d=o(2057),g=o(3738),p=o(6097),f=o(5484),m=o(337),y=o(643),Z=o(6355),v=o(2443);const I=["hourlyTemplate"],T=["saveCalculationModal"],b=["estimatorPdfModal"];function x(e,t){if(1&e&&(c.TgZ(0,"option",51),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("ngValue",e._id),c.xp6(1),c.hij(" ",e.countryName," ")}}function M(e,t){if(1&e&&(c.TgZ(0,"option",52),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("value",e._id),c.xp6(1),c.hij(" ",e.serviceName," ")}}const A=function(){return{backdrop:"static",keyboard:!1,animated:!0}},q=function(){return{isAnimated:!1,dateInputFormat:"DD/MM/YYYY",showWeekNumbers:!1,adaptivePosition:!0}};let C=(()=>{class e{constructor(e,t,o,i,n,s,c,u,h,d,g){this.activatedRoute=e,this.router=t,this.savedProposalService=o,this.manageService=i,this.subRegionsService=n,this.regionsService=s,this.jwtService=c,this.alertService=u,this.spinner=h,this.toastr=d,this.globalService=g,this.title="Hourly Calculation | Estimation Calculator",this.hourlyInfo=new l,this.manageServicesList=[],this.subRegionsList=[],this.hourlyWiseConfig={},this.requiredValidation=new r.NZ,this.optionsHourly={floor:5,ceil:40,autoHideLimitLabels:!0,showSelectionBar:!0},this.optionsWeekly={floor:1,ceil:52,autoHideLimitLabels:!0,showSelectionBar:!0},this.saveCalculationModal=a.oB,this.estimatorPdfModal=a.oB,this.DateRange={minDate:new Date,maxDate:new Date},this.DateRange.minDate.setDate(this.DateRange.minDate.getDate()),this.DateRange.maxDate.setDate(this.DateRange.minDate.getDate()+20),this.getManageServicesList(),this.getSubRegionsList();let p=this.activatedRoute.snapshot.params.id;p&&(this.hourlyInfoIdData(p),this.getRegionDetail())}hourlyInfoIdData(e){this.savedProposalService.getProposal({_id:e}).subscribe(e=>{200===e.status&&(e=e.data[0],this.hourlyInfo=JSON.parse(e.estimationData),this.spinner.hide())},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}ngOnInit(){this.globalService.getPageTitle(this.title),this.hourlyWiseConfig=this.jwtService.getConfig().hourlyCalculation,this.optionsHourly.floor=this.hourlyWiseConfig.weeklyhours.min,this.optionsHourly.ceil=this.hourlyWiseConfig.weeklyhours.max,this.optionsWeekly.floor=this.hourlyWiseConfig.timeFrameInWeeks.min,this.optionsWeekly.ceil=this.hourlyWiseConfig.timeFrameInWeeks.max}getManageServicesList(){this.manageService.getManageServices({status:1}).subscribe(e=>{this.spinner.show(),200===e.status&&(this.spinner.hide(),this.manageServicesList=e=e.data)},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}getSubRegionsList(){this.subRegionsService.getSubRegionsList().subscribe(e=>{this.spinner.show(),200===e.status&&(this.spinner.hide(),this.subRegionsList=e=e.data,this.spinner.hide())},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}getRegionDetail(e){if(e){const t=this.subRegionsList.find(t=>t._id===e);this.regionsService.getRegionsList({_id:t.regionId,status:1}).subscribe(e=>{this.spinner.show(),200===e.status&&(this.spinner.hide(),this.hourlyInfo.region=(e=e.data).length?Object.assign({},...e):{}),this.calculation()},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}else this.hourlyInfo.region={},this.calculation()}calculation(e){e&&(this.hourlyInfo.selectedService=this.manageServicesList.find(t=>e===t._id));let t=this.hourlyInfo.hourly*this.hourlyInfo.weeks;this.hourlyInfo.timeIndex=t;let o=this.hourlyInfo.selectedService.hourlyPrice*(this.hourlyInfo.selectedService.expertise**2/100),i=1;i=t>600?.8*o:t>400?.9*o:t<200?1.25*o:1*o;const a=i*this.hourlyInfo.region.regionFactor*this.hourlyInfo.currencies.currencyFactor,n=a-a*this.hourlyInfo.discount/100;this.hourlyInfo.finalPriceWithDiscount=(Math.round(100*n)/100).toFixed(2),this.hourlyInfo.totalCost=Math.round(n*this.hourlyInfo.timeIndex*100/100).toFixed(2),this.hourlyInfo.validate=this.validateForm()}calculationModal(){this.alertService.clear(),this.saveCalculationModal.show()}closeModel(){this.saveCalculationModal.hide(),this.estimatorPdfModal.hide()}validateForm(){return!!(this.hourlyInfo.regionId&&this.hourlyInfo.region._id&&this.hourlyInfo.selectedService&&this.hourlyInfo.hourly&&this.hourlyInfo.totalCost&&this.hourlyInfo.weeks)}showCalculationInPdf(){let e=JSON.parse(JSON.stringify(this.hourlyInfo));if(Object.keys(this.requiredValidation).filter(t=>!e[t]).length)return this.alertService.clear(),this.alertService.error("*Please Fill All Fields are mandatory."),this.spinner.hide(),!1;this.alertService.clear(),this.saveCalculationModal.hide(),this.estimatorPdfModal.show()}downloadAsPDF(){this.spinner.show();const e=document.getElementById("hourlyTemplate"),t=new n.ZP("p","mm","a4");t.html(e,{html2canvas:{scale:.198}}).then(()=>{t.save("download.pdf"),this.closeModel(),this.saveProposal(),this.router.navigate(["/saved-proposal"])})}saveProposal(){this.spinner.show();let e=JSON.parse(JSON.stringify(this.hourlyInfo)),t={projectName:e.projectName,prospectName:e.prospectName,type:e.type,tags:e.tags,expiryDate:e.expiryDate,status:e.status,estimationData:JSON.stringify(e)};delete t.prospectName,delete t.expiryDate,this.savedProposalService.saveProposal(t).subscribe(e=>{200===e.status&&(this.spinner.hide(),this.toastr.success(e.message,"Success!"),e=e.data)},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(i.gz),c.Y36(i.F0),c.Y36(r.cC),c.Y36(r.sp),c.Y36(r.p9),c.Y36(r.EY),c.Y36(r.Tj),c.Y36(r.c9),c.Y36(u.t2),c.Y36(h._W),c.Y36(r.Uh))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-hourly"]],viewQuery:function(e,t){if(1&e&&(c.Gf(I,5),c.Gf(T,5),c.Gf(b,5)),2&e){let e;c.iGM(e=c.CRH())&&(t.hourlyTemplate=e.first),c.iGM(e=c.CRH())&&(t.saveCalculationModal=e.first),c.iGM(e=c.CRH())&&(t.estimatorPdfModal=e.first)}},decls:94,vars:30,consts:[[1,"d-flex","flex-row"],[1,"col-12"],[1,"opacity-50"],[1,"container-fluid","bg-white","py-3","dataDisplaySection"],[1,"row","g-3","mb-3"],[1,"col-lg-6"],[1,"mb-3"],["for","countryId",1,"form-label"],[3,"ngClass"],[1,"fas","fa-star","fa-xs"],["id","countryId","name","countryId",1,"form-select",3,"ngModel","ngModelChange"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],["for","serviceId",1,"form-label"],["id","selectedService","name","selectedService",1,"form-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"form-label"],[3,"ngModel","options","ngModelChange"],[1,"align-items-start","col-lg-6"],[3,"calculationData","callParentCalculation","calculationModal"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade",3,"config"],["saveCalculationModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row","row-xs","align-items-center","mg-b-20"],["for","projectName",1,"form-label"],["type","text","id","projectName","placeholder","Type Here","name","projectName","characterOnly","",1,"form-control",3,"ngModel","ngModelChange"],["for","prospectName",1,"form-label"],["type","text","id","prospectName","placeholder","Type Here","name","prospectName",1,"form-control",3,"ngModel","ngModelChange"],["for","tags",1,"form-label"],["type","text","id","tags","placeholder","Type Tags Here","name","tags","characterOnly","",1,"form-control",3,"ngModel","ngModelChange"],[1,"row"],["for","expiryDate",1,"col-auto","col-form-label"],[1,"col-auto"],[1,"input-group"],["type","text","id","expiryDate","name","expiryDate","autocomplete","off","bsDatepicker","","placeholder","Select Date","onkeypress","return false",1,"form-control",3,"bsConfig","ngModel","minDate","maxDate","ngModelChange"],["dp","bsDatepicker"],[1,"input-group-text",3,"click"],[1,"icon-calendar"],[1,"modal-footer","border-top-0","justify-content-start"],["type","submit",1,"btn","btn-primary",3,"click"],["estimatorPdfModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","modal-xl"],[1,"modal-body",2,"overflow","auto","max-height","555px"],[3,"calculationData"],[1,"modal-footer","border-top-0","justify-content-center"],[3,"ngValue"],[3,"value"]],template:function(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"h4",2),c.TgZ(3,"h4"),c._uU(4,"Hourly Wise Calculation"),c.qZA(),c.qZA(),c._UZ(5,"hr"),c.qZA(),c.qZA(),c.TgZ(6,"div",3),c.TgZ(7,"div",4),c.TgZ(8,"div",5),c.TgZ(9,"div",6),c.TgZ(10,"label",7),c._uU(11,"Country "),c.TgZ(12,"sup",8),c._UZ(13,"i",9),c.qZA(),c.qZA(),c.TgZ(14,"select",10),c.NdJ("ngModelChange",function(e){return t.hourlyInfo.regionId=e})("ngModelChange",function(){return t.getRegionDetail(t.hourlyInfo.regionId)}),c.TgZ(15,"option",11),c._uU(16,"Select Region"),c.qZA(),c.YNc(17,x,2,2,"option",12),c.qZA(),c.qZA(),c.TgZ(18,"div",6),c.TgZ(19,"label",13),c._uU(20,"Choose Service "),c.TgZ(21,"sup",8),c._UZ(22,"i",9),c.qZA(),c.qZA(),c.TgZ(23,"select",14),c.NdJ("ngModelChange",function(e){return t.hourlyInfo.serviceId=e})("ngModelChange",function(e){return t.calculation(e)}),c.TgZ(24,"option",11),c._uU(25,"Select Service"),c.qZA(),c.YNc(26,M,2,2,"option",15),c.qZA(),c.qZA(),c.TgZ(27,"div",6),c.TgZ(28,"label",16),c._uU(29),c.qZA(),c.TgZ(30,"ngx-slider",17),c.NdJ("ngModelChange",function(e){return t.hourlyInfo.hourly=e})("ngModelChange",function(){return t.calculation()}),c.qZA(),c.qZA(),c.TgZ(31,"div",6),c.TgZ(32,"label",16),c._uU(33),c.qZA(),c.TgZ(34,"ngx-slider",17),c.NdJ("ngModelChange",function(e){return t.hourlyInfo.weeks=e})("ngModelChange",function(){return t.calculation()}),c.qZA(),c.qZA(),c.qZA(),c.TgZ(35,"div",18),c.TgZ(36,"app-estimator-card",19),c.NdJ("callParentCalculation",function(){return t.calculation()})("calculationModal",function(){return t.calculationModal()}),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(37,"div",20,21),c.TgZ(39,"div",22),c.TgZ(40,"div",23),c.TgZ(41,"div",24),c.TgZ(42,"h4",25),c._uU(43,"Save Calculation"),c.qZA(),c.TgZ(44,"button",26),c.NdJ("click",function(){return t.closeModel()}),c.TgZ(45,"span",27),c._uU(46,"\xd7"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(47,"div",28),c.TgZ(48,"div",29),c.TgZ(49,"div",6),c.TgZ(50,"label",30),c._uU(51," Project Name "),c.TgZ(52,"sup",8),c._UZ(53,"i",9),c.qZA(),c.qZA(),c.TgZ(54,"input",31),c.NdJ("ngModelChange",function(e){return t.hourlyInfo.projectName=e}),c.qZA(),c.qZA(),c.TgZ(55,"div",6),c.TgZ(56,"label",32),c._uU(57,"Prospect Name "),c.TgZ(58,"sup",8),c._UZ(59,"i",9),c.qZA(),c.qZA(),c.TgZ(60,"input",33),c.NdJ("ngModelChange",function(e){return t.hourlyInfo.prospectName=e}),c.qZA(),c.qZA(),c.TgZ(61,"div",6),c.TgZ(62,"label",34),c._uU(63," Tags "),c.TgZ(64,"sup",8),c._UZ(65,"i",9),c.qZA(),c.qZA(),c.TgZ(66,"input",35),c.NdJ("ngModelChange",function(e){return t.hourlyInfo.tags=e}),c.qZA(),c.qZA(),c.qZA(),c.TgZ(67,"div",36),c.TgZ(68,"label",37),c._uU(69,"Expiry Date "),c.TgZ(70,"sup",8),c._UZ(71,"i",9),c.qZA(),c.qZA(),c.TgZ(72,"div",38),c.TgZ(73,"div",39),c.TgZ(74,"input",40,41),c.NdJ("ngModelChange",function(e){return t.hourlyInfo.expiryDate=e}),c.qZA(),c.TgZ(76,"span",42),c.NdJ("click",function(){return c.CHM(e),c.MAs(75).toggle()}),c._UZ(77,"i",43),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c._UZ(78,"app-alert"),c.TgZ(79,"div",44),c.TgZ(80,"button",45),c.NdJ("click",function(){return t.showCalculationInPdf()}),c._uU(81,"Enter "),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(82,"div",20,46),c.TgZ(84,"div",47),c.TgZ(85,"div",23),c.TgZ(86,"div",48),c._UZ(87,"app-estimator-pdf",49),c.qZA(),c._UZ(88,"app-alert"),c.TgZ(89,"div",50),c.TgZ(90,"button",45),c.NdJ("click",function(){return t.downloadAsPDF()}),c._uU(91,"Save PDF "),c.qZA(),c.TgZ(92,"button",45),c.NdJ("click",function(){return t.closeModel()}),c._uU(93,"cancel "),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}2&e&&(c.xp6(12),c.Q6J("ngClass",t.hourlyInfo.regionId?"text-primary":"text-danger"),c.xp6(2),c.Q6J("ngModel",t.hourlyInfo.regionId),c.xp6(3),c.Q6J("ngForOf",t.subRegionsList),c.xp6(4),c.Q6J("ngClass",t.hourlyInfo.selectedService?"text-primary":"text-danger"),c.xp6(2),c.Q6J("ngModel",t.hourlyInfo.serviceId),c.xp6(3),c.Q6J("ngForOf",t.manageServicesList),c.xp6(3),c.hij("Weekly Hours : ",t.hourlyInfo.hourly," "),c.xp6(1),c.Q6J("ngModel",t.hourlyInfo.hourly)("options",t.optionsHourly),c.xp6(3),c.hij("Time Frame in Weeks : ",t.hourlyInfo.weeks," "),c.xp6(1),c.Q6J("ngModel",t.hourlyInfo.weeks)("options",t.optionsWeekly),c.xp6(2),c.Q6J("calculationData",t.hourlyInfo),c.xp6(1),c.Q6J("config",c.DdM(27,A)),c.xp6(15),c.Q6J("ngClass",t.hourlyInfo.projectName?"text-primary":"text-danger"),c.xp6(2),c.Q6J("ngModel",t.hourlyInfo.projectName),c.xp6(4),c.Q6J("ngClass",t.hourlyInfo.prospectName?"text-primary":"text-danger"),c.xp6(2),c.Q6J("ngModel",t.hourlyInfo.prospectName),c.xp6(4),c.Q6J("ngClass",t.hourlyInfo.tags?"text-primary":"text-danger"),c.xp6(2),c.Q6J("ngModel",t.hourlyInfo.tags),c.xp6(4),c.Q6J("ngClass",t.hourlyInfo.expiryDate?"text-primary":"text-danger"),c.xp6(4),c.Q6J("bsConfig",c.DdM(28,q))("ngModel",t.hourlyInfo.expiryDate)("minDate",t.DateRange.minDate)("maxDate",t.DateRange.maxDate),c.xp6(8),c.Q6J("config",c.DdM(29,A)),c.xp6(5),c.Q6J("calculationData",t.hourlyInfo))},directives:[d.mk,g.EJ,g.JJ,g.On,g.YN,g.Kr,d.sg,p.w5,f._,a.oB,g.Fj,m.y,y.Y5,y.Np,Z.w,v.I],styles:[""]}),e})();const D=[{path:"",component:C,pathMatch:"full"},{path:":id",component:C,pathMatch:"full"}];let S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[i.Bz.forChild(D)],i.Bz]}),e})(),N=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[r.eY,S]]}),e})()}}]);