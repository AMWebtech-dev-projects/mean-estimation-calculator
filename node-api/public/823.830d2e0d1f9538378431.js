(self.webpackChunkangular=self.webpackChunkangular||[]).push([[823],{2823:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ManageBundlesModule:()=>U});var s=i(2057),n=i(6090),r=i(7988),a=i(5551),l=i(9765);class d{constructor(){this.serviceBundle="",this.serviceId="",this.type=1,this.status=1}}class o{constructor(){this.serviceBundle="",this.serviceId="",this.type="",this.servicePrice=""}}var c=i(793),u=i(6633),g=i(9866),h=i(9699),Z=i(3738),p=i(337),v=i(3358),f=i(6355),m=i(5921);const b=["addEditBundleServiceModal"],A=["deleteBundleServiceModal"];function T(e,t){if(1&e&&(c.TgZ(0,"option",47),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("ngValue",e._id),c.xp6(1),c.hij(" ",e.serviceName," ")}}function q(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"tr"),c.TgZ(1,"th",48),c._uU(2),c.qZA(),c.TgZ(3,"td"),c._uU(4),c.qZA(),c.TgZ(5,"td"),c._uU(6),c.qZA(),c.TgZ(7,"td"),c._uU(8),c.qZA(),c.TgZ(9,"td"),c._uU(10),c.qZA(),c.TgZ(11,"td"),c._uU(12),c.ALo(13,"date"),c.qZA(),c.TgZ(14,"td"),c.TgZ(15,"ui-switch",49),c.NdJ("change",function(){const t=c.CHM(e).$implicit;return c.oxw().changeServiceStatus(t)})("ngModelChange",function(t){return c.CHM(e).$implicit.status=t}),c.qZA(),c.qZA(),c.TgZ(16,"td",15),c.TgZ(17,"div",50),c.TgZ(18,"button",51),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw().showAddEditModal(t)}),c._UZ(19,"i",52),c.qZA(),c.TgZ(20,"button",53),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw().showDeleteModal(t)}),c._UZ(21,"i",54),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit,i=t.index,s=c.oxw();c.xp6(2),c.Oqu(i+1),c.xp6(2),c.Oqu(e.serviceBundle),c.xp6(2),c.Oqu(s.showServiceName(e.serviceId)),c.xp6(2),c.Oqu(s.showType(e.type)),c.xp6(2),c.Oqu(e.servicePrice),c.xp6(2),c.Oqu(c.xi3(13,7,e.createdAt,"d/M/yyyy")),c.xp6(3),c.Q6J("ngModel",e.status)}}function S(e,t){if(1&e&&(c.TgZ(0,"option",47),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("ngValue",e._id),c.xp6(1),c.hij(" ",e.serviceName," ")}}function B(e,t){1&e&&(c.TgZ(0,"p",55),c._uU(1," This Service Bundle Already Exists, please try another one. "),c.qZA())}function x(e,t){if(1&e&&(c.TgZ(0,"option",47),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("ngValue",e.value),c.xp6(1),c.hij(" ",e.label," ")}}const M=function(){return{backdrop:"static",keyboard:!1,animated:!0}},_=[{path:"",component:(()=>{class e{constructor(e,t,i,s,n,c,u){this.jwtService=e,this.bundlesService=t,this.manageService=i,this.alertService=s,this.spinner=n,this.toastr=c,this.globalService=u,this.title="Manage Service Bundles | Estimation Calculator",this.manageBundlesInfo=new d,this.manageBundlesList=[],this.manageServicesList=[],this.checkbundleExists=!1,this.datatableElement=r.G,this.dtOptions={},this.dtTrigger=new l.xQ,this.config={},this.typeList=[],this.filterService_id="",this.addEditBundleServiceModal=a.oB,this.deleteBundleServiceModal=a.oB,this.requiredValidation=new o,this.getManageServicesList(),this.getBundlesList()}ngOnInit(){this.config=this.jwtService.getConfig(),this.typeList=this.config.type,this.dtOptions={responsive:!0,scrollX:!0,scrollY:"350px",scrollCollapse:!0,columnDefs:[{targets:6,orderable:!1,searchable:!1},{targets:7,orderable:!1,searchable:!1}]},this.globalService.getPageTitle(this.title)}ngAfterViewInit(){this.dtTrigger.next()}getManageServicesList(){this.manageService.getManageServices({status:1}).subscribe(e=>{this.spinner.show(),200===e.status&&(this.spinner.hide(),this.manageServicesList=e=e.data)},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}showServiceName(e){if(this.manageServicesList&&this.manageServicesList.length){let t=this.manageServicesList.find(t=>t._id===e);return t?t.serviceName:""}return""}getBundlesList(){let e={};this.filterService_id&&(e.serviceId=this.filterService_id),this.bundlesService.getBundlesList(e).subscribe(e=>{this.spinner.show(),200===e.status&&(this.spinner.hide(),e=e.data,this.datatableElement.dtInstance.then(t=>{t.destroy(),this.dtTrigger.next(),this.manageBundlesList=e,this.spinner.hide()}))},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}showType(e){if(this.typeList&&this.typeList.length){let t=this.typeList.find(t=>t.value===e);return t?t.label:""}return""}closeModel(){this.addEditBundleServiceModal.hide(),this.deleteBundleServiceModal.hide()}showAddEditModal(e){this.alertService.clear(),this.checkbundleExists=!1,this.manageBundlesInfo=e&&e._id?Object.assign({},e):new d,this.addEditBundleServiceModal.show()}showDeleteModal(e){this.manageBundlesInfo=e,this.deleteBundleServiceModal.show()}checkvalidation(e){return Object.assign({},this.manageBundlesInfo)[e]?"text-primary":"text-danger"}bundleExistCheck(e){if(e)if(this.manageBundlesList.length){let t=this.manageBundlesList.find(t=>e._id?e._id!==t._id&&t.serviceBundle.toLowerCase()===e.serviceBundle.toLowerCase():t.serviceBundle.toLowerCase()===e.serviceBundle.toLowerCase());this.checkbundleExists=!!t}else this.checkbundleExists=!1;else this.checkbundleExists=!1}addService(){const e=Object.keys(this.requiredValidation);let t=JSON.parse(JSON.stringify(this.manageBundlesInfo));const i=e.filter(e=>!t[e]);if(this.spinner.show(),i.length||this.checkbundleExists)return this.alertService.clear(),this.alertService.error("*Please Fill All Fields are mandatory."),this.spinner.hide(),!1;let s=JSON.parse(JSON.stringify(this.manageBundlesInfo));this.bundlesService.saveServiceInfo(s).subscribe(e=>{200===e.status&&(this.spinner.hide(),this.toastr.success(e.message,"Success!"),e=e.data,this.closeModel(),console.log("dataRes",e),this.getBundlesList())},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}changeServiceStatus(e){this.bundlesService.saveServiceInfo({_id:e._id,status:e.status?0:1}).subscribe(e=>{if(200===e.status){e=e.data,this.spinner.hide(),this.toastr.success("Service Bundle status has been changed successfully.","Success!");let t=this.manageBundlesList.findIndex(t=>t._id===e._id);t&&(this.manageBundlesList[t].status=e.status)}},e=>{this.spinner.hide(),this.toastr.error(e.message,"Error!")})}deleteService(){this.spinner.show(),this.bundlesService.deleteService(this.manageBundlesInfo).subscribe(e=>{200===e.status&&(this.closeModel(),this.spinner.hide(),this.getBundlesList(),this.toastr.success(e.message,"Success"))},e=>{this.closeModel(),this.spinner.hide(),this.toastr.error("There are some server error.Please check connection.","Error")})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(u.Tj),c.Y36(u.i6),c.Y36(u.sp),c.Y36(u.c9),c.Y36(g.t2),c.Y36(h._W),c.Y36(u.Uh))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-manage-bundles"]],viewQuery:function(e,t){if(1&e&&(c.Gf(r.G,5),c.Gf(b,5),c.Gf(A,5)),2&e){let e;c.iGM(e=c.CRH())&&(t.datatableElement=e.first),c.iGM(e=c.CRH())&&(t.addEditBundleServiceModal=e.first),c.iGM(e=c.CRH())&&(t.deleteBundleServiceModal=e.first)}},decls:112,vars:23,consts:[[1,"d-flex","flex-row"],[1,"col-12"],[1,"opacity-50"],[1,"container-fluid","app-region","bg-white","py-3","dataDisplaySection"],[1,"d-flex","flex-row","justify-content-between","mb-3"],[1,"row"],["for","serviceId",1,"col-auto","form-label","pt-2"],[1,"col-auto"],["id","serviceId","name","serviceId",1,"form-select",3,"ngModel","ngModelChange"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"],["datatable","",1,"table","table-bordered","table-hover","table-striped",3,"dtOptions","dtTrigger"],[1,"text-nowrap"],[1,"text-center"],[1,"text-wrap"],[4,"ngFor","ngForOf"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade",3,"config"],["addEditBundleServiceModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row","row-xs","align-items-center","mg-b-20"],[1,"mb-3"],["for","serviceId",1,"form-label"],[3,"ngClass"],[1,"fas","fa-star","fa-xs"],["for","serviceBundle",1,"form-label"],["type","text","maxlength","20","id","serviceBundle","placeholder","Enter Service Bundle Name","name","serviceBundle","characterOnly","",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger mt-1 mb-0","role","alert",4,"ngIf"],["for","type",1,"form-label"],["id","type","name","type",1,"form-select",3,"ngModel","ngModelChange"],["for","servicePrice",1,"form-label"],["type","text","id","servicePrice","numbersOnly","","placeholder","Enter Service Price","name","servicePrice",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer","border-top-0","justify-content-start"],["type","submit",1,"btn","btn-primary",3,"click"],["deleteBundleServiceModal","bs-modal"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"fa","fa-trash"],[1,"modal-footer","border-top-0","d-flex","justify-content-start"],["type","button",1,"btn","btn-default","me-1",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[3,"ngValue"],["scope","row"],["color","#4285F4","defaultBgColor","#d9d9d9","labelOn","Active","labelOff","Inactive",3,"ngModel","change","ngModelChange"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-sm","edit","me-1",3,"click"],[1,"far","fa-edit"],["type","button",1,"btn","btn-sm","delete",3,"click"],[1,"far","fa-trash-alt"],["role","alert",1,"alert","alert-danger","mt-1","mb-0"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"h4",2),c._uU(3,"Manage Service Bundles"),c.qZA(),c._UZ(4,"hr"),c.qZA(),c.qZA(),c.TgZ(5,"div",3),c.TgZ(6,"div",4),c.TgZ(7,"div"),c.TgZ(8,"div",5),c.TgZ(9,"h6",6),c._uU(10,"Filter By Service: "),c.qZA(),c.TgZ(11,"div",7),c.TgZ(12,"select",8),c.NdJ("ngModelChange",function(e){return t.filterService_id=e})("ngModelChange",function(){return t.getBundlesList()}),c.TgZ(13,"option",9),c._uU(14,"Select Service"),c.qZA(),c.YNc(15,T,2,2,"option",10),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(16,"div"),c.TgZ(17,"button",11),c.NdJ("click",function(){return t.showAddEditModal()}),c._UZ(18,"i",12),c._uU(19,"Add New"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(20,"table",13),c.TgZ(21,"thead"),c.TgZ(22,"tr",14),c.TgZ(23,"th"),c._uU(24,"S.No"),c.qZA(),c.TgZ(25,"th"),c._uU(26,"Service Bundle"),c.qZA(),c.TgZ(27,"th"),c._uU(28,"Service Name"),c.qZA(),c.TgZ(29,"th"),c._uU(30,"Type"),c.qZA(),c.TgZ(31,"th"),c._uU(32,"Service Price"),c.qZA(),c.TgZ(33,"th"),c._uU(34,"Created At"),c.qZA(),c.TgZ(35,"th"),c._uU(36,"Status"),c.qZA(),c.TgZ(37,"th",15),c._uU(38,"Actions"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(39,"tbody",16),c.YNc(40,q,22,10,"tr",17),c.qZA(),c.qZA(),c.qZA(),c.TgZ(41,"div",18,19),c.TgZ(43,"div",20),c.TgZ(44,"div",21),c.TgZ(45,"div",22),c.TgZ(46,"h4",23),c._uU(47),c.qZA(),c.TgZ(48,"button",24),c.NdJ("click",function(){return t.closeModel()}),c.TgZ(49,"span",25),c._uU(50,"\xd7"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(51,"div",26),c.TgZ(52,"div",27),c.TgZ(53,"div",28),c.TgZ(54,"label",29),c._uU(55,"Service Name "),c.TgZ(56,"sup",30),c._UZ(57,"i",31),c.qZA(),c.qZA(),c.TgZ(58,"select",8),c.NdJ("ngModelChange",function(e){return t.manageBundlesInfo.serviceId=e}),c.TgZ(59,"option",9),c._uU(60,"Select Service"),c.qZA(),c.YNc(61,S,2,2,"option",10),c.qZA(),c.qZA(),c.TgZ(62,"div",28),c.TgZ(63,"label",32),c._uU(64," Service Bundle "),c.TgZ(65,"sup",30),c._UZ(66,"i",31),c.qZA(),c.qZA(),c.TgZ(67,"input",33),c.NdJ("ngModelChange",function(e){return t.manageBundlesInfo.serviceBundle=e})("ngModelChange",function(){return t.bundleExistCheck(t.manageBundlesInfo)}),c.qZA(),c.YNc(68,B,2,0,"p",34),c.qZA(),c.TgZ(69,"div",28),c.TgZ(70,"label",35),c._uU(71,"Type "),c.TgZ(72,"sup",30),c._UZ(73,"i",31),c.qZA(),c.qZA(),c.TgZ(74,"select",36),c.NdJ("ngModelChange",function(e){return t.manageBundlesInfo.type=e}),c.TgZ(75,"option",9),c._uU(76,"Choose Type"),c.qZA(),c.YNc(77,x,2,2,"option",10),c.qZA(),c.qZA(),c.TgZ(78,"div",28),c.TgZ(79,"label",37),c._uU(80,"Service Price "),c.TgZ(81,"sup",30),c._UZ(82,"i",31),c.qZA(),c.qZA(),c.TgZ(83,"input",38),c.NdJ("ngModelChange",function(e){return t.manageBundlesInfo.servicePrice=e}),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c._UZ(84,"app-alert"),c.TgZ(85,"div",39),c.TgZ(86,"button",40),c.NdJ("click",function(){return t.addService()}),c._uU(87),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(88,"div",18,41),c.TgZ(90,"div",42),c.TgZ(91,"div",21),c.TgZ(92,"div",22),c.TgZ(93,"h4",23),c._UZ(94,"i",43),c._uU(95," Delete Service Bundle"),c.qZA(),c.TgZ(96,"button",24),c.NdJ("click",function(){return t.closeModel()}),c.TgZ(97,"span",25),c._uU(98,"\xd7"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(99,"div",26),c.TgZ(100,"h4"),c._uU(101,"Are you sure want to delete this Service Bundle?"),c.qZA(),c.TgZ(102,"p"),c.TgZ(103,"b"),c._uU(104,"Service Bundle :"),c.qZA(),c._uU(105),c._UZ(106,"br"),c.qZA(),c.qZA(),c.TgZ(107,"div",44),c.TgZ(108,"button",45),c.NdJ("click",function(){return t.closeModel()}),c._uU(109,"Close"),c.qZA(),c.TgZ(110,"button",46),c.NdJ("click",function(){return t.deleteService()}),c._uU(111,"Delete"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(12),c.Q6J("ngModel",t.filterService_id),c.xp6(3),c.Q6J("ngForOf",t.manageServicesList),c.xp6(5),c.Q6J("dtOptions",t.dtOptions)("dtTrigger",t.dtTrigger),c.xp6(20),c.Q6J("ngForOf",t.manageBundlesList),c.xp6(1),c.Q6J("config",c.DdM(21,M)),c.xp6(6),c.hij("",t.manageBundlesInfo._id?"Edit":"Add"," Service Bundle"),c.xp6(9),c.Q6J("ngClass",t.checkvalidation("serviceId")),c.xp6(2),c.Q6J("ngModel",t.manageBundlesInfo.serviceId),c.xp6(3),c.Q6J("ngForOf",t.manageServicesList),c.xp6(4),c.Q6J("ngClass",t.checkvalidation("serviceBundle")),c.xp6(2),c.Q6J("ngModel",t.manageBundlesInfo.serviceBundle),c.xp6(1),c.Q6J("ngIf",t.checkbundleExists),c.xp6(4),c.Q6J("ngClass",t.checkvalidation("type")),c.xp6(2),c.Q6J("ngModel",t.manageBundlesInfo.type),c.xp6(3),c.Q6J("ngForOf",t.typeList),c.xp6(4),c.Q6J("ngClass",t.checkvalidation("servicePrice")),c.xp6(2),c.Q6J("ngModel",t.manageBundlesInfo.servicePrice),c.xp6(4),c.hij("",t.manageBundlesInfo._id?"Update":"Add"," "),c.xp6(1),c.Q6J("config",c.DdM(22,M)),c.xp6(17),c.hij(" ",t.manageBundlesInfo.serviceBundle," "))},directives:[Z.EJ,Z.JJ,Z.On,Z.YN,Z.Kr,s.sg,r.G,a.oB,s.mk,Z.Fj,Z.nD,p.y,s.O5,v.Y,f.w,m.o],pipes:[s.uU],styles:[""]}),e})(),pathMatch:"full"}];let y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[n.Bz.forChild(_)],n.Bz]}),e})(),U=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[s.ez,u.eY,y]]}),e})()}}]);